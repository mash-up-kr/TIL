# AWS EC2

내가 만든 서비스로 외부에서 접근하려면 24시간 작동하는 서버가 필요하다. 24시간 작동하는 서버는 3가지 방법이 있다.

- 집에 PC를 24시간 구동시키기
- 호스팅 서비스(Cafe 24, 코리아호스팅 등)을 이용
- 클라우드 서비스(AWS, AZURE, GCP 등)을 이용

일반적으로 비용은 집 PC를 이용하거나 호스팅 서비스를 이용하는 것이 저렴하다.  
특정 시간에만 트래픽이 몰린다면 유동적으로 사양을 늘릴 수 있는 클라우드가 유리하다.

클라우드 서비스는 인터넷을 통해 서버, 스토리지(파일 저장소), 데이터베이스, 네트워크, 소프트웨어, 모니터링 등의 컴퓨팅 서비스를 제공한다. 단순히 물리 장비를 대여하는 것 뿐 아니라, 여러가지 서비스들도 같이 제공해준다.

예를 들면 AWS의 EC2는 서버 장비를 대여해준다. 그 안에 로그 관리, 모니터링, 하드웨어 교체, 네트워크 관리 등의 서비스를 기본적으로 지원해준다. 클라우드에도 몇 가지 형태가 있다.

1. IaaS (Infrastructure as a Service, 아이아스, 이에스)
   1. 기존 물리 장비를 미들웨어와 함께 묶어둔 추상화 서비스
   2. 가상 머신, 스토리지, 네트워크, 운영체제 등의 IT 인프라를 대여해주는 서비스
   3. AWS의 EC2, S3 등
2. PaaS (Platform as a Service, 파스)
   1. 1번의 IaaS를 한 번 더 추상화한 서비스
   2. 추상화 했기에 많은 기능이 자동화
   3. AWS의 Beanstalk(빈스톡), Heroku(헤로쿠) 등
3. SaaS (Software as a Service, 사스)
   1. 소프트웨어 서비스
   2. 구글 드라이브, 드랍박스, 와탭 등

AWS의 장점은 다음과 같다.
- 첫 가입 시 1년간 대부분 서비스가 무료다. 그러나 서비스마다 제한은 있다.
- 클라우드에서는 기본적으로 지원하는 기능(모니터링, 로그관리, 백업, 복구, 클러스터링 등)이 많아 개인이나 소규모일 때 개발에 좀 더 집중할 수 있다.
- 많은 기업이 AWS로 이전 중으로 AWS 사용 경험은 많은 도움이 된다.
- 사용자가 많아 국내 자료와 커뮤니티가 활성화되어 있다.

PaaS 서비스인 빈스톡을 사용하면, 무료로 사용하는 프리티어로는 무중단 배포가 불가능하기에 쓰지 않는다.

## EC2 인스턴스 생성

AWS EC2 프리티어는 다음과 같은 제한이 있다.

- 사양이 t2.micro만 가능
  - vCPU(가상 CPU) 1 Core, 메모리 1GB 사양
  - 보통 vCPU는 물리 CPU 사양의 절반 정도의 성능
- 월 750시간의 제한이 있고 초과하면 비용 부과
  - 24시간 * 31일 = 744시간
  - 1 대의 t2.micro만 사용한다면 24시간 사용이 가능

Region(리전)은 AWS의 서비스가 구동될 지역을 뜻한다. AWS는 도시별로 클라우드 센터를 지어 해당 센터에서 구축된 가상머신들을 사용한다.  
이전에는 도쿄 리전을 사용했지만, 서울 리전이 새로 나왔다. 우측 상단의 리전을 서울로 바꿀 수 있다.

인스턴스를 생성하는 첫 단계는 AMI(Amzon Machine Image, 아마존 머신 이미지)를 선택하는 것이다. EC2 인스턴스를 시작하는데 필요한 정보를 이미지로 만들어 둔 것을 뜻한다. 운영체제 등을 설치할 수 있게 구운 이미지다. 아마존 리눅스 1 AMI 를 선택한다. Amazon Linux AMI 를 선택하고 다음 버튼을 누른다.

아마존 리눅스 2 대신에 아마존 리눅스 1을 선택한 이유는 리눅스 1의 자료가 더 많기 때문이다. 센토스(Centos) 6 버전으로 진행할 수 있는 자료들 모두 아마존 리눅스 1에서 사용할 수 있다. 아마존 리눅스 2는 센토스 7 버전의 자료들을 사용할 수 있다.

센토스 AMI를 사용하지 않고 아마존 리눅스 AMI를 사용하는 이유는 다음과 같다.
- 아마존이 개발하고 있기에 지원받기 쉽다.
- 레드햇 베이스로 레드햇 계열을 잘 다루는 사람이라면 아무 문제 없이 쓸 수 있다.
- AWS의 각종 서비스와의 상성이 좋다.
- Amazon 만의 갭라 리포지토리를 사용해 yum (패키지 매니저) 이 매우 빠르다.

AWS의 인스턴스 유형 중 T 시리즈는 범용 시리즈라 불린다. 다양한 사양을 사용할 수 있다. AWS는 크레딧 시스템을 사용한다. 크레딧이란 일종의 CPU를 사용할 수 있는 포인트 개념이다. 인스턴스 크기에 따라 정해진 비율로 CPU 크레딧을 계속 받게 된다. 사용하지 않을 때엔 크레딧을 모으고, 사용할 때 크레딧을 사용한다. 정해진 사양보다 더 높은 트래픽이 오면 크레딧을 적극적으로 사용하지만, 크레딧이 모두 소진되면 더이상 EC2를 사용할 수 없다.

트래픽이 높은 서비스들은 T 시리즈를 쓰지 않는다. 그러나 시작 단계에서는 좋은 선택이다.

AWS 서버 용량의 기본값은 8GB다. 프리티어는 30GB까지 가능하다.

# 참고 도서

스프링 부트와 AWS로 혼자 구현하는 웹 서비스